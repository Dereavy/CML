
// Precondition: We are facing cardinal direction that chest array is
// located towards.

$$<wheatBot_chestPositions.txt>

UNSAFE(0)

    // In chest 1 (left), place seeds and extra items
    
    LOOKS(%#block1_yaw%,%#block1_pitch%,.2)
    WAIT(5t)
    
    // Open chest
    UNSET(@open_chest)
    EXEC("openChest.txt")
    DO
        WAIT(1t)
    UNTIL(@open_chest)
    
        UNSET(@place_all_except)
        EXEC("placeAllExcept.txt","placeAllExcept","wheat hay_block")
        DO
            WAIT(1t)
        UNTIL(@place_all_except)

        UNSET(@take_specific)
        EXEC("takeSpecific.txt","takeSpecific","wheat hay_block")
        DO
            WAIT(1t)
        UNTIL(@take_specific)

        // Take at least 8 stacks of seed
        UNSET(@take_at_least)
        EXEC("takeAtLeast.txt","takeAtLeast","wheat_seeds",512)
        DO
            WAIT(1t)
        UNTIL(@take_at_least)

        // Take at least 64 food items
        UNSET(@take_at_least)
        EXEC("takeAtLeast.txt","takeAtLeast","food",64)
        DO
            WAIT(1t)
        UNTIL(@take_at_least)
        
    // Close chest
    UNSET(@close_chest)
    EXEC("closeChest.txt")
    DO
        WAIT(1t)
    UNTIL(@close_chest)
    
    // In chest 2, place all wheat and haybales (product)
    
    LOOKS(%#block2_yaw%,%#block2_pitch%,.2)
    WAIT(5t)
    
    // Open chest
    UNSET(@open_chest)
    EXEC("openChest.txt")
    DO
        WAIT(1t)
    UNTIL(@open_chest)
    
        UNSET(@place_specific)
        EXEC("placeSpecific.txt","placeSpecific","wheat hay_block")
        DO
            WAIT(1t)
        UNTIL(@place_specific)

        UNSET(@take_all_except)
        EXEC("takeAllExcept.txt","takeAllExcept","wheat hay_block")
        DO
            WAIT(1t)
        UNTIL(@take_all_except)
        
    // Close chest
    UNSET(@close_chest)
    EXEC("closeChest.txt")
    DO
        WAIT(1t)
    UNTIL(@close_chest)



    
    SET(@wheat_handle_chests)

ENDUNSAFE
